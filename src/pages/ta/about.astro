---
import Layout from "../../layouts/Layout.astro";
import AboutPage from "../../components/Aboutpage.jsx";
import { getLangFromUrl, loadTina, loadContent } from "../../utils/i18n.js";

const lang = getLangFromUrl(Astro.url) || "en";

// This is equivalent to getStaticProps in Next.js
const pageResponse = await loadTina(lang, "about");
const siteConfig = await loadContent(lang, "site_config");

// Prepare props for the React component
const tinaProps = {
  data: pageResponse.data,
  query: pageResponse.query,
  variables: pageResponse.variables,
};
const aboutData = (pageResponse.data as any)[`about_${lang}`] || {};
---

<Layout
  title={`About - ${siteConfig.organization?.name}`}
  description={aboutData.hero?.description || "About our organization"}
  lang={lang}
>
  <AboutPage
    props={tinaProps}
    lang={lang}
    client:load
  />
</Layout>