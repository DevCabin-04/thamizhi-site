---
import Layout from "../layouts/Layout.astro";
import { getLangFromUrl, loadContentSafe } from "../utils/i18n";

const lang = getLangFromUrl(Astro.url);
const publicationsContent = await loadContentSafe(lang, "publications");
const siteConfig = await loadContentSafe(lang, "site_config");
---

<Layout
    title={`Publications - ${siteConfig.organization?.name}`}
    description={publicationsContent.hero?.description}
    lang={lang}
>
    <!-- Page Header -->
    <section
        class="bg-gradient-to-br from-orange-600 via-red-600 to-amber-600 text-white relative overflow-hidden"
    >
        <!-- Decorative Pattern -->
        <div class="absolute inset-0 opacity-10">
            <div
                class="absolute inset-0"
                style='background-image: url(&apos;data:image/svg+xml,<svg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><g fill="%23ffffff" fill-opacity="0.1"><circle cx="7" cy="7" r="7"></circle><circle cx="53" cy="7" r="7"></circle><circle cx="7" cy="53" r="7"></circle><circle cx="53" cy="53" r="7"></circle></g></g></svg>&apos;); background-size: 60px 60px;'
            >
            </div>
        </div>
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 relative">
            <div class="max-w-3xl">
                <h1 class="text-4xl lg:text-5xl font-bold mb-4">
                    {publicationsContent.hero?.title}
                </h1>
                <h2
                    class="text-2xl lg:text-3xl font-medium text-orange-100 mb-6"
                >
                    {publicationsContent.hero?.subtitle}
                </h2>
                <p class="text-xl text-orange-100">
                    {publicationsContent.hero?.description}
                </p>
            </div>
        </div>
    </section>

    <!-- Publication Categories -->
    <section class="py-16 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-900 mb-4">
                    Publication Categories
                </h2>
                <p class="text-lg text-gray-600">
                    Explore our diverse collection of Tamil literature and
                    resources
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                {
                    publicationsContent.categories?.map((category) => (
                        <div class="bg-white rounded-lg shadow-md p-6 text-center hover:shadow-lg transition-shadow cursor-pointer">
                            <div class="w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                <svg
                                    class="w-8 h-8 text-orange-600"
                                    fill="currentColor"
                                    viewBox="0 0 24 24"
                                >
                                    {category.icon === "book" && (
                                        <path d="M18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 4h5v8l-2.5-1.5L6 12V4z" />
                                    )}
                                    {category.icon === "magazine" && (
                                        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z" />
                                    )}
                                    {category.icon === "research" && (
                                        <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
                                    )}
                                    {category.icon === "newsletter" && (
                                        <path d="M20 6h-2.18c.11-.31.18-.65.18-1a2.996 2.996 0 0 0-5.5-1.65l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-2 .89-2 2v11c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm0 13H4V8h16v11z" />
                                    )}
                                    {!category.icon && (
                                        <path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z" />
                                    )}
                                </svg>
                            </div>
                            <h3 class="text-lg font-semibold text-gray-900 mb-2">
                                {category.name}
                            </h3>
                            <p class="text-gray-600 text-sm mb-3">
                                {category.description}
                            </p>
                            <div class="text-orange-600 font-medium">
                                {category.count} items
                            </div>
                        </div>
                    ))
                }
            </div>
        </div>
    </section>

    <!-- Featured Publications -->
    <section class="py-16 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-900 mb-4">
                    Featured Publications
                </h2>
                <p class="text-lg text-gray-600">
                    Highlighted works from our collection
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                {
                    publicationsContent.featured_publications?.map(
                        (publication) => (
                            <div class="bg-gray-50 rounded-lg overflow-hidden shadow-md hover:shadow-lg transition-shadow">
                                <div class="h-48 bg-gradient-to-br from-orange-200 to-red-300 flex items-center justify-center">
                                    <div class="text-center">
                                        <svg
                                            class="w-16 h-16 mx-auto mb-2 text-orange-600"
                                            fill="currentColor"
                                            viewBox="0 0 24 24"
                                        >
                                            <path d="M18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 4h5v8l-2.5-1.5L6 12V4z" />
                                        </svg>
                                        <div class="text-orange-600 font-medium text-sm">
                                            {publication.type}
                                        </div>
                                    </div>
                                </div>

                                <div class="p-6">
                                    <h3 class="text-xl font-bold text-gray-900 mb-2">
                                        {publication.title}
                                    </h3>
                                    {publication.title_tamil && (
                                        <h4 class="text-lg text-orange-600 mb-3">
                                            {publication.title_tamil}
                                        </h4>
                                    )}

                                    <div class="text-sm text-gray-600 mb-3">
                                        <p>
                                            <strong>Author:</strong>{" "}
                                            {publication.author}
                                        </p>
                                        {publication.year && (
                                            <p>
                                                <strong>Year:</strong>{" "}
                                                {publication.year}
                                            </p>
                                        )}
                                        {publication.pages && (
                                            <p>
                                                <strong>Pages:</strong>{" "}
                                                {publication.pages}
                                            </p>
                                        )}
                                    </div>

                                    <p class="text-gray-700 text-sm mb-4 line-clamp-3">
                                        {publication.description}
                                    </p>

                                    <div class="flex items-center justify-between">
                                        {publication.price ? (
                                            <div class="text-lg font-bold text-orange-600">
                                                {publication.price}
                                            </div>
                                        ) : (
                                            <div class="text-green-600 font-medium">
                                                Free
                                            </div>
                                        )}
                                        {publication.availability && (
                                            <div class="text-sm text-gray-500">
                                                {publication.availability}
                                            </div>
                                        )}
                                    </div>

                                    <div class="flex gap-2 mt-4">
                                        <button class="flex-1 bg-orange-600 hover:bg-orange-700 text-white py-2 px-4 rounded-lg font-medium transition-colors">
                                            {publication.price
                                                ? "Purchase"
                                                : "Download"}
                                        </button>
                                        <button class="flex-1 border border-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-50 transition-colors">
                                            Preview
                                        </button>
                                    </div>
                                </div>
                            </div>
                        ),
                    )
                }
            </div>
        </div>
    </section>

    <!-- Recent Publications -->
    <section class="py-16 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-900 mb-4">
                    Recent Publications
                </h2>
                <p class="text-lg text-gray-600">
                    Latest additions to our library
                </p>
            </div>

            <div class="space-y-6">
                {
                    publicationsContent.recent_publications?.map(
                        (publication) => (
                            <div class="bg-white rounded-lg p-6 shadow-sm hover:shadow-md transition-shadow">
                                <div class="flex flex-col md:flex-row gap-6">
                                    <div class="w-full md:w-32 h-40 bg-gradient-to-br from-orange-200 to-red-300 rounded-lg flex items-center justify-center flex-shrink-0">
                                        <svg
                                            class="w-12 h-12 text-orange-600"
                                            fill="currentColor"
                                            viewBox="0 0 24 24"
                                        >
                                            <path d="M18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 4h5v8l-2.5-1.5L6 12V4z" />
                                        </svg>
                                    </div>

                                    <div class="flex-1">
                                        <div class="flex flex-col lg:flex-row lg:justify-between lg:items-start mb-3">
                                            <div>
                                                <h3 class="text-xl font-bold text-gray-900 mb-1">
                                                    {publication.title}
                                                </h3>
                                                {publication.title_tamil && (
                                                    <h4 class="text-lg text-orange-600 mb-2">
                                                        {
                                                            publication.title_tamil
                                                        }
                                                    </h4>
                                                )}
                                            </div>
                                            <div class="text-right">
                                                {publication.price ? (
                                                    <div class="text-lg font-semibold text-orange-600">
                                                        {publication.price}
                                                    </div>
                                                ) : (
                                                    <div class="text-green-600 font-medium">
                                                        Free
                                                    </div>
                                                )}
                                                <div class="text-sm text-gray-500">
                                                    {publication.type}
                                                </div>
                                            </div>
                                        </div>

                                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4 text-sm text-gray-600">
                                            <div>
                                                <strong>Author:</strong>{" "}
                                                {publication.author}
                                            </div>
                                            {publication.year && (
                                                <div>
                                                    <strong>Published:</strong>{" "}
                                                    {publication.year}
                                                </div>
                                            )}
                                            {publication.pages && (
                                                <div>
                                                    <strong>Pages:</strong>{" "}
                                                    {publication.pages}
                                                </div>
                                            )}
                                        </div>

                                        <p class="text-gray-700 mb-4">
                                            {publication.description}
                                        </p>

                                        <div class="flex flex-col sm:flex-row gap-3">
                                            <button class="bg-orange-600 text-white px-6 py-2 rounded-lg hover:bg-orange-700 transition-colors">
                                                {publication.price
                                                    ? "Purchase"
                                                    : "Download"}
                                            </button>
                                            <button class="border border-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-50 transition-colors">
                                                Preview
                                            </button>
                                            <button class="border border-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-50 transition-colors">
                                                Add to Library
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        ),
                    )
                }
            </div>
        </div>
    </section>

    <!-- Publication Submission -->
    {
        publicationsContent.submission && (
            <section class="py-16 bg-orange-50">
                <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                    <h2 class="text-3xl font-bold text-gray-900 mb-4">
                        {publicationsContent.submission.title}
                    </h2>
                    <p class="text-lg text-gray-600 mb-8">
                        {publicationsContent.submission.description}
                    </p>

                    {publicationsContent.submission.guidelines && (
                        <div class="bg-white/50 backdrop-blur-sm rounded-xl p-6 mb-8 text-left max-w-2xl mx-auto">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4">
                                Submission Guidelines
                            </h3>
                            <ul class="space-y-2 text-gray-700">
                                {publicationsContent.submission.guidelines.map(
                                    (guideline) => (
                                        <li class="flex items-start">
                                            <svg
                                                class="w-5 h-5 text-orange-600 mt-0.5 mr-2 flex-shrink-0"
                                                fill="currentColor"
                                                viewBox="0 0 24 24"
                                            >
                                                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" />
                                            </svg>
                                            <span class="text-sm">
                                                {guideline}
                                            </span>
                                        </li>
                                    ),
                                )}
                            </ul>
                        </div>
                    )}

                    <div class="flex flex-col sm:flex-row gap-4 justify-center">
                        <button class="bg-orange-600 text-white px-8 py-3 rounded-lg hover:bg-orange-700 transition-colors">
                            Submit Publication
                        </button>
                        <button class="border border-gray-300 text-gray-700 px-8 py-3 rounded-lg hover:bg-gray-50 transition-colors">
                            Guidelines & Forms
                        </button>
                    </div>
                </div>
            </section>
        )
    }

    <!-- Newsletter Subscription -->
    <section class="py-16 bg-white">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h2 class="text-3xl font-bold text-gray-900 mb-4">Stay Updated</h2>
            <p class="text-lg text-gray-600 mb-8">
                Subscribe to receive notifications about new publications and
                literary events.
            </p>

            <div class="bg-gray-50 rounded-xl p-8 max-w-md mx-auto">
                <div class="flex flex-col gap-4">
                    <input
                        type="email"
                        placeholder="Enter your email address"
                        class="px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                    />
                    <button
                        class="bg-orange-600 hover:bg-orange-700 text-white py-3 px-6 rounded-lg font-medium transition-colors"
                    >
                        Subscribe to Updates
                    </button>
                </div>
                <p class="text-sm text-gray-500 mt-4">
                    We respect your privacy. Unsubscribe at any time.
                </p>
            </div>
        </div>
    </section>
</Layout>
